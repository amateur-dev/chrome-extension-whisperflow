<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=350, height=280">
  <link rel="stylesheet" href="styles.css">
  <title>VibeCoding</title>
</head>
<body>
  <div class="container">
    <div class="header">
      <span class="logo-icon">ğŸ™ï¸</span>
      <h1>VibeCoding</h1>
    </div>

    <!-- Idle State -->
    <div class="screen idle-screen active" id="idleScreen">
      <button id="recordBtn" class="btn btn-primary">
        ğŸ™ï¸ CLICK TO RECORD
      </button>
      <div class="status-bar">
        <p class="status">Status: <span id="status">Ready</span></p>
        <p class="model-status">Model: <span id="modelStatus">Loading...</span></p>
      </div>
      <div class="footer-actions">
        <button class="btn-link" id="settingsBtn">âš™ï¸ Settings</button>
        <button class="btn-link" id="historyBtn">ğŸ“‹ History</button>
      </div>
    </div>

    <!-- Recording State -->
    <div class="screen recording-screen" id="recordingScreen">
      <p class="title">ğŸ™ï¸ Recording...</p>
      <canvas id="waveform" class="waveform" width="300" height="60"></canvas>
      <div class="recording-info">
        <p class="volume-label">Volume: <span id="volumeBar" class="volume-bar">â–°â–°â–°â–°â–°â–°â–°â–°â–¯â–¯</span></p>
        <p class="duration">Duration: <span id="duration">0:00</span></p>
      </div>
      <button id="stopBtn" class="btn btn-danger">â¹ï¸ STOP RECORDING</button>
    </div>

    <!-- Transcribing State -->
    <div class="screen transcribing-screen" id="transcribingScreen">
      <p class="title">ğŸ”„ Transcribing...</p>
      <div class="spinner"></div>
      <p class="info-text" id="transcribingInfo">Processing audio with<br>Moonshine (local)</p>
      <p class="info-subtext" id="transcribingSubtext" style="font-size: 10px; color: #888; margin-top: 8px;">First time may take 30-60s to download ~50MB model</p>
    </div>

    <!-- Formatting State -->
    <div class="screen formatting-screen" id="formattingScreen">
      <p class="title">âœ¨ Formatting...</p>
      <div class="spinner"></div>
      <p class="info-text">Applying AI polish<br>(no cloud calls)</p>
    </div>

    <!-- Preview State -->
    <div class="screen preview-screen" id="previewScreen">
      <p class="title">âœ… Ready to Send!</p>
      <div class="preview">
        <div class="text-section original">
          <label>ORIGINAL:</label>
          <p id="originalText" class="text-content"></p>
        </div>
        <div class="text-section formatted">
          <label>FORMATTED:</label>
          <p id="formattedText" class="text-content"></p>
        </div>
      </div>
      <div class="actions">
        <button id="insertBtn" class="btn btn-success">â¡ï¸ INSERT</button>
        <button id="copyBtn" class="btn btn-secondary">ğŸ“‹ COPY</button>
      </div>
      <div class="secondary-actions">
        <button id="retryBtn" class="btn-link">ğŸ” Retry</button>
        <button id="clearBtn" class="btn-link">ğŸ—‘ï¸ Clear</button>
      </div>
    </div>

    <!-- Error State -->
    <div class="screen error-screen" id="errorScreen">
      <p class="title">âŒ Error</p>
      <p id="errorMessage" class="error-text"></p>
      <button id="errorRetryBtn" class="btn btn-primary">ğŸ” Try Again</button>
    </div>

    <!-- Settings State -->
    <div class="screen settings-screen" id="settingsScreen">
      <p class="title">âš™ï¸ Settings</p>
      
      <div class="settings-section">
        <label class="settings-label">Speech-to-Text Model</label>
        <div class="model-options">
          <div class="model-option" id="moonshineOption">
            <input type="radio" name="sttModel" id="moonshineRadio" value="moonshine" checked>
            <label for="moonshineRadio" class="model-card">
              <span class="model-name">ğŸŒ™ Moonshine Tiny</span>
              <span class="model-info">~20-44 MB â€¢ 27M params â€¢ MIT</span>
              <span class="model-status-badge" id="moonshineStatus">Default</span>
            </label>
          </div>
          <div class="model-option" id="whisperOption">
            <input type="radio" name="sttModel" id="whisperRadio" value="whisper">
            <label for="whisperRadio" class="model-card">
              <span class="model-name">ğŸ¤ Whisper Tiny</span>
              <span class="model-info">~71 MB â€¢ Requires download</span>
              <span class="model-status-badge" id="whisperStatus">Not Downloaded</span>
            </label>
          </div>
        </div>
      </div>

      <div class="download-section" id="downloadSection" style="display: none;">
        <div class="download-progress">
          <p class="download-text" id="downloadText">Downloading Whisper model...</p>
          <div class="progress-bar">
            <div class="progress-fill" id="progressFill" style="width: 0%"></div>
          </div>
          <p class="download-percent" id="downloadPercent">0%</p>
        </div>
      </div>

      <div class="settings-section" style="margin-top: 16px;">
        <label class="settings-label">âŒ¨ï¸ Keyboard Shortcut</label>
        <div class="shortcuts-list" style="font-size: 12px; color: #ccc; margin-top: 8px;">
          <div class="shortcut-item" style="display: flex; justify-content: space-between; margin-bottom: 8px;">
            <span>Open popup:</span>
            <code style="background: #333; padding: 2px 6px; border-radius: 3px;">Alt+Shift+V</code>
          </div>
        </div>
      </div>

      <div class="settings-actions">
        <button id="saveSettingsBtn" class="btn btn-success">ğŸ’¾ Save</button>
        <button id="backBtn" class="btn btn-secondary">â† Back</button>
      </div>
    </div>
  </div>

  <script src="popup.js"></script>
</body>
</html>
